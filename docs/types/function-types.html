<!DOCTYPE HTML>
<html lang="en" >
    <head><meta charset="UTF-8">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"><title>Function Types · Jekyll Gitbook</title><meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="description" content="Build Jekyll site with the GitBook style.
"><meta name="generator" content="Jekyll (using style of GitBook 3.2.3)"><meta name="author" content="HE Tao"><link rel="stylesheet" href="/gitbook/style.css">
<link rel="stylesheet" href="/gitbook/gitbook-plugin-fontsettings/website.css">
<!-- <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css"> -->

<link rel="stylesheet" href="/gitbook/rouge-highlight-colorful.css">

<meta name="HandheldFriendly" content="true"/>
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/gitbook/images/apple-touch-icon-precomposed-152.png">
<link rel="shortcut icon" href="/gitbook/images/favicon.ico" type="image/x-icon">
            <link rel="prev" href="/" />
        

        
    </head>
    <body>
        <div class="book"><div class="book-summary">
    <div id="book-search-input" role="search">
        <input type="text" placeholder="Type to search" />
    </div>
    <nav role="navigation">
        <ul class="summary">
            
            <li class="chapter" data-level="1.1" data-path="">
            
                <a href="">
                    Jekyll Gitbook
                </a>
            </li>

            <li class="divider"></li>

            

            
                
                <li class="chapter" data-level="1.1" data-path="/jekyll/2019-04-27-why.html">
                
                    <a href="/jekyll/2019-04-27-why.html">
                        Why Jekyll with GitBook
                    </a>
                </li>
            
                
                <li class="chapter" data-level="1.1" data-path="/jekyll/2019-04-28-howto.html">
                
                    <a href="/jekyll/2019-04-28-howto.html">
                        How to Get Started
                    </a>
                </li>
            
                
                <li class="chapter" data-level="1.1" data-path="/jekyll/2019-04-28-license.html">
                
                    <a href="/jekyll/2019-04-28-license.html">
                        License
                    </a>
                </li>
            

            <li class="divider"></li>

            <li>
                <a href="https://github.com/sighingnow/jekyll-gitbook/fork" target="blank" class="gitbook-link">
                    Fork it Now!
                </a>
            </li>
        </ul>
    </nav>
</div><div class="book-body"><div class="body-inner">
    <div class="book-header" role="navigation">
        <!-- Title -->
        <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i>
            
                <a href="." >Function Types</a>
            
        </h1>
    </div>
    <div class="page-wrapper" tabindex="-1" role="main">
        <div class="page-inner">
            <div id="book-search-results">
                <div class="search-noresults">
                    <section class="normal markdown-section">

                        
                            <h1 id="">Function Types</h1>
                        

                        <h1 id="function-types">Function Types</h1>
<p>As a functional programming language, the type of functions in Enso (<code class="highlighter-rouge">-&gt;</code>) is
key. There are a few things that should be noted about functions in Enso.</p>

<blockquote>
  <p>The actionables for this section:</p>

  <ul>
    <li>Work out a full specification for function typing and behaviour.</li>
    <li>Calling a function with an upper-case letter instantiates all of its type
arguments to free type variables.</li>
  </ul>
</blockquote>

<!-- MarkdownTOC levels="2,3" autolink="true" -->

<ul>
  <li><a href="#scoping">Scoping</a></li>
  <li><a href="#structural-type-shorthand">Structural Type Shorthand</a></li>
  <li><a href="#function-composition">Function Composition</a></li>
</ul>

<!-- /MarkdownTOC -->

<h2 id="scoping">Scoping</h2>
<p>Enso’s scoping rules should be fairly familiar to most other programming
languages, as it uses standard lexical scoping with shadowing. However, there
are a few unique points to keep in mind:</p>

<ul>
  <li>There is no separation between the type and term levels. This means that, for
a given lexical scope, type, function and lambda variables exist in the same
name space.</li>
  <li>This means that if different names are used on the type and value level to
refer to the same entity, both names are valid.</li>
  <li>Name clashes between different entities are not allowed.</li>
  <li>Shadowing between different lexical scopes occurs as standard.</li>
  <li>Shadowing in the same lexical scope may only occur in a chain of lambdas, and
in such a case the shadowed variables must unify.</li>
  <li>Variables from the body are accessible in the type signature.</li>
  <li>Variables from the type signature are accessible in the body.</li>
</ul>

<p>Scope lookup proceeds from the function body outwards, as is standard for
lexical scoping. For a detailed discussion of scoping, please see
<a href="../semantics/scoping.md">the scoping documentation</a>.</p>

<h2 id="structural-type-shorthand">Structural Type Shorthand</h2>
<p>In Enso, we want to be able to write a type-signature that represents types in
terms of the operations that take place on the input values. A classical example
is <code class="highlighter-rouge">add</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">add</span> <span class="p">:</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">b</span> <span class="o">-&gt;</span> <span class="n">b</span> <span class="o">+</span> <span class="n">a</span>
<span class="n">add</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">b</span> <span class="o">-&gt;</span> <span class="n">b</span> <span class="o">+</span> <span class="n">a</span>
</code></pre></div></div>

<p>There are a few things to note about this signature from a design standpoint:</p>

<ul>
  <li><code class="highlighter-rouge">a</code> and <code class="highlighter-rouge">b</code> are not the same type. This may, at first glance, seem like a
signature that can’t work, but the return type, in combination with our
integrated <code class="highlighter-rouge">Convertible</code> mechanism gives us the tools to make it work.</li>
  <li>The return type is <code class="highlighter-rouge">a + b</code>. This is a shorthand expression for a detailed
desugaring. The desugaring provided below is what the typechecker would infer
based on such a signature.</li>
</ul>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">add</span> <span class="p">:</span> <span class="n">forall</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="n">d</span><span class="o">.</span> <span class="p">({</span><span class="o">+</span> <span class="p">:</span> <span class="no">Convertible</span> <span class="n">b</span> <span class="n">c</span> <span class="o">=&gt;</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">c</span> <span class="o">-&gt;</span> <span class="n">d</span><span class="p">}</span> <span class="o">&lt;</span><span class="p">:</span> <span class="n">a</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">b</span> <span class="o">-&gt;</span> <span class="n">d</span>
</code></pre></div></div>

<p>This may look fairly strange at first, but we can work through the process as
follows:</p>

<ol>
  <li>The expression <code class="highlighter-rouge">b + a</code> is syntactic sugar for a method call on a: <code class="highlighter-rouge">a.+ b</code>.</li>
  <li>This means that there must be a <code class="highlighter-rouge">+</code> method on a that takes both an <code class="highlighter-rouge">a</code> and a
<code class="highlighter-rouge">b</code>, with return-type unspecified as of yet: <code class="highlighter-rouge">+ : a -&gt; b -&gt; ?</code></li>
  <li>However, as <code class="highlighter-rouge">Convertible</code> is built into the language, we have to consider
that for <code class="highlighter-rouge">a.+ b</code> to work, the <code class="highlighter-rouge">+</code> method can actually take any type to which
<code class="highlighter-rouge">b</code> converts. This introduces the constraint <code class="highlighter-rouge">Convertible b c</code>, and we get
<code class="highlighter-rouge">+ : a -&gt; c -&gt; ?</code></li>
  <li>The return type from a function need not be determined by its arguments, so
hence in the general case we have to default to an unrestricted type variable
giving <code class="highlighter-rouge">+ a -&gt; c -&gt; d</code>.</li>
  <li>This method must exist on the type <code class="highlighter-rouge">a</code>, resulting in the constraint that the
row <code class="highlighter-rouge">{+ : a -&gt; c -&gt; d} &lt;: a</code> must conform to that interface.</li>
  <li>We now know the return type of <code class="highlighter-rouge">a + b</code>, and can rewrite it in the signature
as <code class="highlighter-rouge">d</code>.</li>
</ol>

<p>Please note that <code class="highlighter-rouge">a &lt;: b</code> (which can be flipped as <code class="highlighter-rouge">:&gt;</code>) means that <code class="highlighter-rouge">a</code> is a row
that is a sub-row contained within the row <code class="highlighter-rouge">b</code>. The containment relation allows
for the possibility that <code class="highlighter-rouge">a == b</code>.</p>

<p>The inferred type for any function should, in general, match the given type
signature. Cases where this break down should only exist where the type
signature acts to constrain the function type further than would be inferred.</p>

<blockquote>
  <p>The actionables for this section are:</p>

  <p>PLEASE NOTE. THIS IS OUT OF DATE.</p>

  <ul>
    <li>Clean it up and work out how it applies in light of the new developments of
typesets.</li>
  </ul>
</blockquote>

<h2 id="function-composition">Function Composition</h2>
<p>Enso introduces a function composition operator which composes functions after
all arguments have been applied. This operator is <code class="highlighter-rouge">&gt;&gt;</code> (and its backwards cousin
<code class="highlighter-rouge">&lt;&lt;</code>). It takes a function <code class="highlighter-rouge">f</code> with <code class="highlighter-rouge">n</code> arguments, and a function <code class="highlighter-rouge">g</code> with <code class="highlighter-rouge">m</code>
arguments, and the result consumes <code class="highlighter-rouge">n</code> arguments, applies them to <code class="highlighter-rouge">f</code>, and then
applies the result of that plus any additional arguments to <code class="highlighter-rouge">g</code>.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">computeCoeff</span> <span class="o">=</span> <span class="p">(</span><span class="o">+</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span>

<span class="n">doThing</span> <span class="o">=</span> <span class="p">(</span><span class="o">+</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="o">*</span><span class="p">)</span>
</code></pre></div></div>

<p>In addition, we have the operator <code class="highlighter-rouge">.</code>, which acts as standard forward function
chaining in Enso, and its backwards chaining cousin <code class="highlighter-rouge">&lt;|</code>.</p>

<blockquote>
  <p>The actionables from this section are:</p>

  <ul>
    <li>Examples for the more advanced use-cases of <code class="highlighter-rouge">&gt;&gt;</code> to decide if the type
complexity is worth it.</li>
    <li>Otherwise, standardise on using <code class="highlighter-rouge">&gt;&gt;</code> and <code class="highlighter-rouge">&lt;&lt;</code> for standard function
composition:
      <ul>
        <li><code class="highlighter-rouge">&lt;&lt; : (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c</code> - backwards composition (standard)</li>
        <li><code class="highlighter-rouge">&gt;&gt; : (a -&gt; b) -&gt; (b -&gt; c) -&gt; a -&gt; c</code> - forwards composition</li>
      </ul>
    </li>
  </ul>
</blockquote>

                    </section>
                </div>

                 <!--<div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>-->
            </div>
        </div>
    </div>
</div>

                    <a href="/" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Jekyll Gitbook">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
            </div>

            <script>
            var gitbook = gitbook || [];
            gitbook.push(function() {
                gitbook.page.hasChanged({
    "page": {
        "title": "Introduction",
        "level": "1.1",
        "depth": 1,
        
        "dir": "ltr"
    },    "config": {
        "plugins": ["fontsettings", "highlight", "livereload", "lunr", "search", "sharing", "theme-default", "livereload"],
        "styles": {
            "ebook": "styles/ebook.css",
            "epub": "styles/epub.css",
            "mobi": "styles/mobi.css",
            "pdf": "styles/pdf.css",
            "print": "styles/print.css",
            "website": "styles/website.css"
        },
        "pluginsConfig": {
            "fontsettings": {
                "family": "sans",
                "size": 2,
                "theme": "white"
            },
            "highlight": {},
            "livereload": {},
            "lunr": {
                "ignoreSpecialCharacters": false,
                "maxIndexSize": 1000000
            },
            "search": {},
            "sharing": {
                "all": ["facebook", "google", "twitter", "weibo", "instapaper"],
                "facebook": true,
                "google": false,
                "instapaper": false,
                "twitter": true,
                "vk": false,
                "weibo": false
            },
            "theme-default": {
                "showLevel": false,
                "styles": {
                    "ebook": "styles/ebook.css",
                    "epub": "styles/epub.css",
                    "mobi": "styles/mobi.css",
                    "pdf": "styles/pdf.css",
                    "print": "styles/print.css",
                    "website": "styles/website.css"
                }
            }
        },
        "theme": "default",
        "author": "Tao He",
        "pdf": {
            "pageNumbers": true,
            "fontSize": 12,
            "fontFamily": "Arial",
            "paperSize": "a4",
            "chapterMark": "pagebreak",
            "pageBreaksBefore": "/",
            "margin": {
                "right": 62,
                "left": 62,
                "top": 56,
                "bottom": 56
            }
        },
        "structure": {
            "langs": "LANGS.md",
            "readme": "README.md",
        },
        "variables": {},
        "title": "Jekyll Gitbook",
        "language": "en",
        "gitbook": "*"
    },
    "file": {
        "path": "docs/types/function-types.md",
        "mtime": "",
        "type": "markdown"
    },
    "gitbook": {
        "version": "3.2.3",
        "time": "2020-05-15 16:44:18 +0000"
    },
    "basePath": "",
    "book": {
        "language": ""
    }
});
            });
            </script>
        </div><script src="/gitbook/gitbook.js"></script>
<script src="/gitbook/theme.js"></script>

<script src="/gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
<script src="/gitbook/gitbook-plugin-sharing/buttons.js"></script>

<!-- <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
<script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
<script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
<script src="../gitbook/gitbook-plugin-search/search.js"></script> --></body>
</html>